---
title: "Analyzing the Insights Behind Food Safety Trends in Toronto"
title-block-banner: true
author: Aaron Xiaozhou Liu
thanks: "Code and data are available at https://github.com/Pix3ls126/Toronto_food_safety"
date: today
date-format: long
abstract: "This paper focuses on the DineSafe dataset from OpenDataToronto to explore the food safety inspections that took place in Toronto. The use of temporal and geospatial analysis helps us to find the reason behind the seasonal trends, spatial patterns, and hotspots of non-compliance. It also gives us an idea of the current status of food safety in the city. We also compare inspection results by facility types, isolate factors determining compliance, monitor rating variation trend, and analyze inconsistencies between official information and public perception data. The results of our research provide various beneficiaries, including policy makers, officials of public health, and foodservice industry stakeholders, with useful information that can be used to improve food safety regulations and guarantee secure dining experiences to residents of Toronto."
format: pdf
toc: true
number-sections: true
bibliography: bibliography.bib
---
```{r}
#| message: false
#| echo: false
#| warning: false
#### Work space setup ####

library("janitor")
library("dplyr")
library("here")
library("opendatatoronto")
library("tidyverse")
library("knitr")
library("readr")
library("arrow")
library("zoo")
library("rstanarm")

#### Reading cleaned data ####
analysis_data <- read_parquet(file = "data/analysis_data/Inspections_fines_per_year.parquet")

```
\newpa

\newpage
## Introduction
Food safety is a crucial issue in the culinary scene of Toronto compared to other urban regions because it is a home to many restaurants that draw guests and local residents. While the diversity of restaurants in the city is indicative of it being a culturally luring place, concern with food quality and safety is also of equal significance. The food safety inspections, those are done by the officials of the Toronto Public Health department under DineSafe system [@DineSafe], have great value as a tool of control over the compliance with health requirements and for protecting the public health. DineSafe represents one of the crucial strong points since the system works through OpenDataToronto which permits for students and researchers that want to learn the food environment of Toronto in more details to have access to such information.

This study will investigate the DineSafe data set, mainly focusing on the temporal and spatial trends associated with food safety inspections in different neighborhoods in Toronto. Through studying the trends of food safety compliance across years and locations, we intend to detect the efficiency of existing food safety systems and point out the areas for improvements. Furthermore, we will dig into the factors that may affect the outcome of an inspection, like establishment type, size, and frequency of inspection giving the in-depth picture of the determinants of compliance within the city's food service industry.

With the overarching goal of enhancing food safety standards and fostering transparency within Toronto's dining establishments, this research endeavors to provide evidence-based insights for policymakers, public health officials, and stakeholders. By analyzing the patterns emerging from DineSafe inspections, we aim to contribute to informed decision-making and the development of targeted interventions to address potential gaps in food safety regulation enforcement. Ultimately, our study seeks to promote a culture of accountability and consumer trust, ensuring that Toronto's vibrant culinary landscape remains a safe and enjoyable experience for all. In @sec-data, we will cover the data and methods of analysis that will be used. We will visualize the results in @sec-results, and finally interpret the results in @sec-discussion and draw conclusions to our findings in @sec-conclusion.
\newpage

## Data {#sec-data}


### Data collection and cleaning
All data collection and analysis was done using statistical computing and data visualization program R [@R] and Rstudio IDE [@RStudioR] to help streamline the workflow. The data used for this paper was found in the opendatatoronto library and downloaded using the R package opendatatoronto [@opendatatorontoR]. All the analysis was done using the R program and the following supporting packages tidyverse [@tidyverseR], Janitor [@JanitorR], dplyer [@dplyrR], ggplot2 [@ggplot2R], knitr [@knitrR], readr [@readrR], and here [@hereR]. We will dive into more detail about the data collection, cleaning, and analysis in the following sections of the paper. 

### Interpreting the data
Once we had our data, obtained using the opendatatoronto [@opendatatorontoR] R package. From this dataset, we see there are many columns of information. We will be ommiting some information, such as the longitude and latitude of different restaurants, as this information isn't relevant for most people, and using an address is much more practical when finding location. Other information such as establishment status and minimum inspection years are also omitted from this research, as the information they provide are relatively consistent among all establishments. The more important features of the dataset that can be potentially explored such as infraction details and infraction severity, which we will dive more in depth into exploring. Below is a table of all the attributes of the dataset and a brief explanation of each.

### Variables of interest
Now that we have a better understanding of the information our dataset is providing us, we can better decide what variables we want to choose to further explore. For the purposes of this paper, we will be investigating infraction details, infraction severity, and establishment type. These variables will show what kind of infractions to food safety most establishments may more commonly commit, and among these different infractions, what kind of infractions are taken most seriously by DineSafe. Another variable that will be the inspection dates, where we will explore trends these inspections over time. Lastly, we will look at the area of establishments where the inspections take place and see if any conclusions can be drawn on hot spots of safety infractions.

\newpage

#### Infraction Types
During an inspection by DineSafe, an establishment must satisfy the inspectors in the following categories [@foodsafety]:

- Food temperature control
- Protecting food from contamination
- Maintenance and sanitation of food contact surfaces and equipment
- Maintenance and sanitation of non-food contact surfaces and equipment
- Maintenance and sanitation of washrooms
- Storage and removal of waste
- Pest control

Of these regulations, if the restaurant fails to meet any of the above requirements, them they are issued an infraction. Infractions have different levels of severity, which will be covered in the next subsection. Gathering data on this column would let us see what kinds of infractions happen more often than others, indicating what actions might need to be taken to help mitigate further occurrences of the same kind of infraction.

#### Infraction severity
Of the previously mentioned infractions, infractions are also labelled with a severity based on how bad the infraction is. This is split among three levels of severity, being minor, significant, and crucial infractions [@foodsafety].

**Minor Infractions**

- Pose minimal health risks, such as chefs not wearing hair ties.
- Can still receive an overall pass in the inspection
- Infraction must be addressed promptly.

**Significant Infractions**

- Violations that pose more significant health risks, such as dirty food surfaces
- Can receive a conditional pass, but must resolve the violation within 24-48 hours

**Crucial Infractions**

- Crucial infractions pose major health concerns such as food contamination and lack of safe water
- Must be dealt with immediately 
- If left unchecked, the establishment will be issued a closure notice

Using this, we can get a general idea of what types of infractions are given what level of severity. We can use this information to draw on conclusions for what establishments should be aware of and make sure that they don't have any infractions that are considered severe enough to be issued a closure notice.

### Amount Fined
The final variable of interest that will be explored is to take a look at the amount fined. We will investigate this with relation to the amount of infractions, as well as relate it to the severity of infractions. We expect to see some correlation between the severity of the infraction compared to amount fined, as more the more dangerous the infraction, the more an establishment would be fined due to negligence. 

## Model
Here, we will discuss the model used in this analysis. A simple Linear regression model is used where we will compare the the amount establishments are fined for infractions per month, and relate that to the amount of infractions per month.

```{r}
#| label: fig-1
#| fig-cap: Amount fined relative to infraction count
#| echo: false
#| message: false
#| warning: false

analysis_data <-

cleaned_Theft_from_Motor_Vehicle |>
  ggplot(aes(x = division)) +
  geom_bar() +
  labs(x = "Police Division #", y = "Number of Motor Thefts", title = 'Number of Motor Thefts per Police Division') +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

## Results {#sec-results}

## Discussion {#sec-discussion}

### Shortcomings and next steps


\newpage
## Conclusion {#sec-conclusion}

\newpage
## Bibliography